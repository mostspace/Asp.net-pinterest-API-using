@model IList<nxPinterest.Data.Models.UserMedia>

<div class="content gallery" id="contentGallery">
    <div class="thumbnail-container">
        @foreach (nxPinterest.Data.Models.UserMedia userMedia in Model)
        {
            await Html.RenderPartialAsync("/Views/Home/_HomeImageDetail.cshtml", userMedia);
        }
    </div>

</div>

<script>
    $(document).ready(function() {
        var page = 2;
        $(window).scroll(function() {
            if($(window).scrollTop() == $(document).height() - $(window).height()) {
               $.ajax({
                    url: "@Url.Action("getMedia", "Home")",
                    method: "Post",
                    data: { pageIndex: page, searchKey: $('#SearchKey').val() },
                    success: function (sResult) {
                        page++;
                        console.log(sResult);
                    }
                });
            }
        });
    });
    function onViewUserMediaDetails(media_id) {
        $("#imagePreview").html("");

        OnGetUserMediaDetails(media_id).then(function (html) {
            $("#contentGallery").hide();
            $("#sectionPagination").hide();
            $(".add-image-container").hide();
            
            $("#imagePreview").append(html);
            $("#imagePreview").show();
        });
    }

    async function OnGetUserMediaDetails(media_id) {
        var promise = await new Promise(function (resolve, reject) {
            $.ajax({
                url: "@Url.Action("GetUserMediaDetails", "Home")",
                method: "Post",
                data: { media_id },
                success: function (sResult) {
                    resolve(sResult);
                }
            });
        });

        return promise;
    }

    function ShowHomeImageContainer() {
        $("#imagePreview").hide();
        $("#imagePreview").html("");
        $(".add-image-container").show();
        $("#sectionPagination").show();
        $("#contentGallery").show();
    }

</script>