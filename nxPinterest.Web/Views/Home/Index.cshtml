@model HomeViewModel
@{
    ViewData["Title"] = "TOP";

    bool hasNextPage = (Model.PageIndex < Model.TotalPages);
    bool hasPreviousPage = (Model.PageIndex > 1);

    var prevDisabled = !hasPreviousPage ? "disabled" : "";
    var nextDisabled = !hasNextPage ? "disabled" : "";
    string searchKey = Model.SearchKey;
    //bool hasPagination = Model.TotalRecords > nxPinterest.Services.dev_Settings.pageSize_regist;
}

    <!-- Start Content-->
    @*<div id="blockGallery">
        <div class="m-3">
             @RenderBody()
        </div>
    </div>
*@

@*    <div class="add-image-container">
        <a onclick="RegiterUserMediaFile();">
            <i class="fas fa-plus-circle fa-3x"></i>
        </a>
    </div>*@
@section Styles {
    <link href="~/lib/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet" />
}

    <script>
        function RegiterUserMediaFile() {
            $('#image-viewer-modal').remove();
            $('#image-registration-modal').modal('show');
        }

        function showLoader() {
            $('.indicator-loader').show();
        }

        function hideLoader() {
            $('.indicator-loader').fadeOut("slow");
        }

        $.urlParam = function (name) {
            var results = new RegExp('[\?&]' + name + '=([^&#]*)')
                .exec(window.location.search);

            return (results !== null) ? results[1] || 0 : false;
        }

        $('.btn-search').on('click', function () {
            var pageIndex = $.urlParam('pageIndex');
            var searchKey = $('input[name="SearchKey"]').val();
            showLoader();
            if (pageIndex == false)
                pageIndex = 1;

            var url = '@Url.Action("Index","Home")' + "?pageIndex=" + pageIndex + "&searchKey=" + searchKey;
            window.location = url;
        });

        $('#SearchKey').keypress(function(event){
            if(event.keyCode == 13){
                var pageIndex = $.urlParam('pageIndex');
                var searchKey = $('input[name="SearchKey"]').val();
                showLoader();
                if (pageIndex == false)
                    pageIndex = 1;

                var url = '@Url.Action("Index","Home")' + "?pageIndex=" + pageIndex + "&searchKey=" + searchKey;
                window.location = url;
            }
        });

        $(document).ready(function () {
            hideLoader();
        });
        function addTags(value) {
            var searchKey = $('#SearchKey').val();
            if (searchKey) {
                searchKey = searchKey.concat(" " + value); 
            } else {
                searchKey = value;
            }
            $('#SearchKey').val(searchKey);
            var url = '@Url.Action("Index","Home")' + "?searchKey=" + searchKey;
            window.location = url;
        }
    </script>

<div id="blockGallery" class="multiImageSelect-noselect">
    <div class="m-3">
        <div class="content gallery" id="contentGallery">
            <div class="thumbnail-container" id="thumbnail-container">
            </div>
        </div>
    </div>
</div>

@{
    await Html.RenderPartialAsync("/Views/Shared/_ImageContainer.cshtml");
}

@{
    await Html.RenderPartialAsync("/Views/Shared/_ImageRegistration.cshtml", Model.ImageRegistrationVM);
}

@section Scripts{
<script src="~/lib/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
<script src="~/lib/bootstrap-datepicker/locales/bootstrap-datepicker.ja.min.js"></script>
    <script src="~/js/user-album/index.js"></script>
    <script>
        var album = new userAlbumController();
           album.initialize();
    </script>
    <script>
       $(document).ready(function(){
            if ($.fn.datepicker) {
                $("#datetimepicker1").datepicker({ language: "ja", format: "YYYY-MM-DD HH:mm:ss", inline: true, sideBySide: true, todayHighlight: true, clearBtn: false });
                $('#datetimepicker1').on('changeDate', function (event) {

                    var formatted_date = event.date;
                    console.info(formatted_date);
                    
                });
            }
       });
    </script>
    <script>
        $(document).ready(function () {
            var uploadMediaButtonEle = document.getElementById("uploadMedia");
            if (uploadMediaButtonEle) {
                uploadMediaButtonEle.style.display = "unset";
            }
        });
        function loadImg() {
            $.ajax({
                url: "@Url.Action("getMedia", "UserMedia")",
                method: "Post",
                data: { pageIndex: window.page, searchKey: $('#SearchKey').val() },
                success: function (sResult) {
                    window.images.push( sResult.userMediaList);
                    $.each(sResult.userMediaList, function(index, value) {
                        appendData(value);
                    });
                    window.page = window.page + 1;
                },
                error: function () {
                    window.images.forEach(function (data) {
                        data.forEach(function (value) {
                            appendData(value);
                        });
                    });
                    window.page = window.page + 1;
                }
            });
        }
    </script>
    }